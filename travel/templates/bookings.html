{% extends 'base.html' %}
{% block content %}

<!-- Your Events -->
<main class="exr-shell mb-4">
  <h1 class="h4 mb-3">Your Events</h1>

<ul class="nav nav-tabs mb-3" id="bookingTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="upcoming-tab" data-bs-toggle="tab"
              data-bs-target="#UpcomingTickets" type="button" role="tab"
              aria-controls="UpcomingTickets" aria-selected="true">
        Upcoming
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="past-tab" data-bs-toggle="tab"
              data-bs-target="#PastTickets" type="button" role="tab"
              aria-controls="PastTickets" aria-selected="false">
        Past
      </button>
    </li>
  </ul>

  <div class="tab-content" id="bookingTabsContent">

  <div class="tab-pane fade show active" id="UpcomingTickets" role="tabpanel">
    <div class="row">
      {% if upcoming %}
      {% for order in upcoming %}
      <div class="col-md-6">
          <div class="card booking-card account-card" data-bs-toggle="collapse" data-bs-target="#OrderDetails{{ order.id }}">
            <img src="{{ url_for('static', filename='uploads/' + order.event.image) }}" class="card-img-top">
            <div class="card-body">
              <h5>{{ order.event.title }}</h5>
              <p class="text-muted">{{ order.event.category.name }}</p>
              <div class="d-flex booking-info">
                <span><i class="bi bi-calendar"></i> {{ order.event.start_at.strftime('%B %d, %Y') }}</span>
                <span><i class="bi bi-ticket"></i> {{ order.quantity }} tickets</span>
              </div>
            </div>
            <div class="collapse" id="OrderDetails{{ order.id }}">
              <div class="card-body">
                <p class="order-number">Order #{{ order.id }}</p>
                <div class="event-info d-flex"><span>Venue:</span><span>{{ order.event.venue }}</span></div>
                <div class="event-info d-flex"><span>Time:</span><span>{{ order.event.start_at.strftime('%I:%M %p') }}</span></div>
                <div class="event-info d-flex"><span>Total:</span><span>A${{ '%.2f'|format(order.total_amount|float) }}</span></div>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
      {% else %}
        <p class="text-muted text-center mt-3">No upcoming tickets.</p>
      {% endif %}
    </div>
  </div>

  <div class="tab-pane fade" id="PastTickets" role="tabpanel">
    <div class="row">
      {% if past %}
        {% for order in past %}
        <div class="col-md-6">
          <div class="card booking-card account-card">
            <img src="{{ url_for('static', filename='uploads/' + order.event.image) }}" class="card-img-top">
            <div class="card-body">
              <h5>{{ order.event.title }}</h5>
              <p class="text-muted">{{ order.event.category.name }}</p>
              <div class="d-flex booking-info">Order #{{ order.id }}
                <span><i class="bi bi-calendar"></i> {{ order.event.start_at.strftime('%B %d, %Y') }}</span>
                <span><i class="bi bi-ticket"></i> {{ order.quantity }} tickets</span>
              </div>
              <div class="d-flex booking-info">
                <span><i class="bi bi-cash"></i> A${{ '%.2f'|format(order.total_amount|float) }}</span>
                <span><i class="bi bi-geo-alt"></i> {{ order.event.venue }}</span>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <p class="text-muted text-center mt-3">No past tickets.</p>
      {% endif %}
    </div>
  </div>
</div>
</main>
{% endblock %}